function [NN,Nr,Ns] = el10_ShapeFunctions(r,s) %#codegen

%% Compute shape functions for 9 node quad

%%
NN = [(1/4).*((-1)+r).*r.*((-1)+s).*s,(1/4).*r.*(1+r).*((-1)+s).*s,( ...
  1/4).*r.*(1+r).*s.*(1+s),(1/4).*((-1)+r).*r.*s.*(1+s),(-1/2).*(( ...
  -1)+r).*(1+r).*((-1)+s).*s,(-1/2).*r.*(1+r).*((-1)+s).*(1+s),( ...
  -1/2).*((-1)+r).*(1+r).*s.*(1+s),(-1/2).*((-1)+r).*r.*((-1)+s).*( ...
  1+s),((-1)+r).*(1+r).*((-1)+s).*(1+s)];

Nr = [(1/4).*((-1)+2.*r).*((-1)+s).*s,(1/4).*(1+2.*r).*((-1)+s).*s,( ...
  1/4).*(1+2.*r).*s.*(1+s),(1/4).*((-1)+2.*r).*s.*(1+s),(-1).*r.*(( ...
  -1)+s).*s,(-1/2).*(1+2.*r).*((-1)+s.^2),(-1).*r.*s.*(1+s),(-1/2).* ...
  ((-1)+2.*r).*((-1)+s.^2),2.*r.*((-1)+s.^2)];

Ns = [(1/4).*((-1)+r).*r.*((-1)+2.*s),(1/4).*r.*(1+r).*((-1)+2.*s),( ...
  1/4).*r.*(1+r).*(1+2.*s),(1/4).*((-1)+r).*r.*(1+2.*s),(-1/2).*(( ...
  -1)+r.^2).*((-1)+2.*s),(-1).*r.*(1+r).*s,(-1/2).*((-1)+r.^2).*(1+ ...
  2.*s),(-1).*((-1)+r).*r.*s,2.*((-1)+r.^2).*s];
